import random
from tensorflow.keras import layers

import tensorflow as tf
import numpy as np

trainDataForPrediction = np.array([[[0.28358589],
  [0.30372512],
  [0.29780091],
  [0.33183642],
  [0.33120391],
  [0.33995099]],

 [[0.66235955],
  [0.35913154],
  [0.44153985],
  [0.32184616],
  [0.36265909],
  [0.3549683 ]],

 [[0.31142234],
  [0.66259034],
  [0.72903083],
  [0.77104302],
  [0.72910771],
  [0.75193211]],

 [[0.90720823],
  [0.72759569],
  [0.62614929],
  [0.69093327],
  [0.73826299],
  [0.72309858]],

 [[0.6095221 ],
  [0.77340943],
  [0.81678509],
  [0.80538922],
  [0.81804642],
  [0.8251804 ]],

 [[0.80261632],
  [0.71335692],
  [0.60358738],
  [0.64392465],
  [0.70798606],
  [0.68685222]],

 [[0.780457  ],
  [0.78226247],
  [0.90243802],
  [0.97144548],
  [0.94602405],
  [0.96125509]],

 [[0.79170093],
  [0.90229303],
  [0.8141366 ],
  [0.80853979],
  [0.78771087],
  [0.77839755]],

 [[0.61180146],
  [0.69044191],
  [0.5812535 ],
  [0.47918308],
  [0.46885173],
  [0.46438816]],

 [[0.62133159],
  [0.46832587],
  [0.45011011],
  [0.43797561],
  [0.46931518],
  [0.49728175]],

 [[0.59755109],
  [0.63108946],
  [0.64450683],
  [0.67581521],
  [0.66612456],
  [0.65878372]],

 [[0.71132382],
  [0.72192407],
  [0.71825596],
  [0.77809111],
  [0.71006228],
  [0.69495688]],

 [[0.4333941 ],
  [0.47057709],
  [0.46120598],
  [0.45281569],
  [0.44260477],
  [0.44248343]],

 [[0.52482055],
  [0.56745374],
  [0.65914372],
  [0.57337102],
  [0.69907015],
  [0.69499166]],

 [[0.51284886],
  [0.33358419],
  [0.31609008],
  [0.23997269],
  [0.08639418],
  [0.08413338]],

 [[0.26429119],
  [0.45916246],
  [0.44680846],
  [0.4449086 ],
  [0.52549847],
  [0.55313779]],

 [[0.4566679 ],
  [0.41502596],
  [0.66814448],
  [0.79515032],
  [0.82469515],
  [0.85223724]],

 [[0.8428317 ],
  [1.        ],
  [0.94682836],
  [0.95609914],
  [0.9859931 ],
  [0.95404273]],

 [[0.89188471],
  [0.92726165],
  [0.86781746],
  [0.8164678 ],
  [0.79838713],
  [0.79180823]],

 [[0.74514082],
  [0.63961743],
  [0.3959561 ],
  [0.65873789],
  [0.66951841],
  [0.69643851]],

 [[0.68831417],
  [0.74602272],
  [0.75794952],
  [0.62336891],
  [0.6014669 ],
  [0.57675219]],

 [[0.29146979],
  [0.41276609],
  [0.60938479],
  [0.7062046 ],
  [0.65504986],
  [0.66181513]],

 [[0.88358238],
  [0.72456903],
  [0.51257023],
  [0.40234096],
  [0.43700235],
  [0.42401991]],

 [[0.3591383 ],
  [0.69884845],
  [0.74231565],
  [0.72416779],
  [0.6708481 ],
  [0.6731879 ]],

 [[0.94124425],
  [0.83152508],
  [0.82366235],
  [0.80077871],
  [0.80614143],
  [0.79487525]],

 [[0.34668558],
  [0.23052622],
  [0.17238472],
  [0.2675286 ],
  [0.26344458],
  [0.28616361]],

 [[0.40986458],
  [0.35779146],
  [0.40335441],
  [0.44973167],
  [0.41253347],
  [0.37845105]],

 [[0.33203832],
  [0.27771177],
  [0.30814096],
  [0.16146156],
  [0.1718526 ],
  [0.18814805]],

 [[0.63741835],
  [0.66444711],
  [0.76911393],
  [0.7553838 ],
  [0.76645967],
  [0.76460272]],

 [[0.33085441],
  [0.44095143],
  [0.35532193],
  [0.43949481],
  [0.46892119],
  [0.4662825 ]],

 [[0.65113037],
  [0.91117417],
  [0.9335289 ],
  [0.89285049],
  [0.89504786],
  [0.91245301]],

 [[0.92886475],
  [0.7068268 ],
  [0.60644207],
  [0.57394975],
  [0.57464331],
  [0.54921686]],

 [[0.23284108],
  [0.22316557],
  [0.20152097],
  [0.45580923],
  [0.45287703],
  [0.45928762]],

 [[0.45123298],
  [0.39450794],
  [0.48112946],
  [0.32824454],
  [0.2944551 ],
  [0.30711642]],

 [[0.66849429],
  [0.6326308 ],
  [0.57193197],
  [0.50133743],
  [0.4672485 ],
  [0.44125429]],

 [[0.3493021 ],
  [0.43485091],
  [0.46408419],
  [0.75744247],
  [0.79000517],
  [0.80664802]],

 [[0.59350822],
  [0.55769807],
  [0.63017208],
  [0.26459647],
  [0.18448017],
  [0.14864757]],

 [[0.2809532 ],
  [0.22152394],
  [0.18470882],
  [0.23680976],
  [0.27114282],
  [0.28851017]],

 [[0.46479513],
  [0.52150761],
  [0.53962938],
  [0.56391452],
  [0.53710149],
  [0.5308821 ]],

 [[0.61977787],
  [0.53154372],
  [0.50561344],
  [0.48908166],
  [0.47152856],
  [0.48861851]],

 [[0.31765691],
  [0.5696298 ],
  [0.68688768],
  [0.611828  ],
  [0.59800787],
  [0.58199944]],

 [[0.59364795],
  [0.44172827],
  [0.31675594],
  [0.35414828],
  [0.36070871],
  [0.39298799]],

 [[0.19718846],
  [0.30401209],
  [0.51566878],
  [0.64076456],
  [0.65299798],
  [0.63290334]],

 [[0.72989215],
  [0.64011724],
  [0.60324933],
  [0.51062346],
  [0.45331722],
  [0.46125121]],

 [[0.549944  ],
  [0.34359706],
  [0.28630835],
  [0.37263408],
  [0.51816687],
  [0.53117809]],

 [[0.7357174 ],
  [0.82513636],
  [0.92903864],
  [0.83082154],
  [0.71830423],
  [0.68545151]]])

trainDataTrueValues = np.array([[0.33370854, 0.32896128, 0.338919  , 0.370148  , 0.41977692, 0.5521488 ],
 [0.365207  , 0.37061936, 0.37484066, 0.3478887 , 0.32885199, 0.30680109],
 [0.75690644, 0.76740645, 0.78093759, 0.80580592, 0.83506068, 0.9300879 ],
 [0.72214934, 0.71222063, 0.70721571, 0.72001991, 0.86853872, 0.78016653],
 [0.81758234, 0.81016924, 0.80366251, 0.81069042, 0.60300473, 0.67470109],
 [0.67958566, 0.68243936, 0.69163868, 0.74519473, 0.68240246, 0.657002  ],
 [0.96831789, 0.96380285, 0.967898  , 0.92530772, 0.9249375 , 0.93694259],
 [0.76195766, 0.74630911, 0.7047356 , 0.69865743, 0.64689554, 0.53129387],
 [0.47209114, 0.48193162, 0.50943131, 0.52597968, 0.65194851, 0.79167671],
 [0.52327628, 0.56134685, 0.60585979, 0.65919966, 0.59725093, 0.57757021],
 [0.65063778, 0.63845143, 0.6223349 , 0.59585136, 0.62452674, 0.66366742],
 [0.66665364, 0.644637  , 0.61860204, 0.60778969, 0.54817006, 0.53309155],
 [0.44629018, 0.43732508, 0.45198314, 0.40540066, 0.45934156, 0.44508884],
 [0.68928946, 0.69242095, 0.66407551, 0.65466724, 0.63588645, 0.62255665],
 [0.07655137, 0.07586849, 0.07615533, 0.09743152, 0.0912761 , 0.16081511],
 [0.57516233, 0.5752103 , 0.58274857, 0.60408212, 0.53677125, 0.38215918],
 [0.87645224, 0.89860724, 0.91237928, 0.90458273, 0.89167839, 0.86169194],
 [0.93496343, 0.91752935, 0.91871312, 0.93298075, 0.90635008, 0.93339182],
 [0.78620334, 0.77966131, 0.76595499, 0.80123668, 0.72281454, 0.67729982],
 [0.71433298, 0.73036564, 0.74620482, 0.71141186, 0.80361011, 0.84697337],
 [0.54462913, 0.5222716 , 0.51101144, 0.52252069, 0.42480727, 0.26657974],
 [0.6645752 , 0.66903111, 0.66718311, 0.66090196, 0.68263579, 0.85079916],
 [0.41923131, 0.42102118, 0.44039002, 0.48348755, 0.48306699, 0.36817135],
 [0.68148362, 0.67589061, 0.66555973, 0.69096076, 0.7228609 , 0.78776612],
 [0.7854791 , 0.78995575, 0.79338535, 0.72868889, 0.65642879, 0.55843462],
 [0.28512477, 0.27293793, 0.25881146, 0.26540709, 0.22930567, 0.33778585],
 [0.37266819, 0.37910424, 0.38644206, 0.36064735, 0.43564156, 0.35146986],
 [0.22257434, 0.23625543, 0.24991159, 0.28900138, 0.30654842, 0.42902441],
 [0.7425433 , 0.73684753, 0.73618661, 0.70964112, 0.67040764, 0.62850268],
 [0.45068071, 0.43816298, 0.4342914 , 0.45724268, 0.43607784, 0.55865807],
 [0.92236959, 0.93100085, 0.92969332, 0.93081777, 0.96367614, 0.89586521],
 [0.5410671 , 0.52699706, 0.52766478, 0.51691315, 0.43398716, 0.33637598],
 [0.46335955, 0.46776761, 0.46408167, 0.44867432, 0.43701596, 0.51659065],
 [0.30417175, 0.30733531, 0.30366558, 0.29330711, 0.36359768, 0.38749372],
 [0.42664812, 0.42056716, 0.43086576, 0.40887337, 0.42715668, 0.57628272],
 [0.82901749, 0.83238729, 0.82457459, 0.84872239, 0.79996528, 0.62709093],
 [0.12056511, 0.10651576, 0.10280307, 0.07995919, 0.07564526, 0.21194409],
 [0.30114611, 0.31115646, 0.31270446, 0.33757487, 0.40753736, 0.43746691],
 [0.52919291, 0.52264534, 0.51790728, 0.51318749, 0.44302725, 0.40943982],
 [0.48224635, 0.48409421, 0.48324061, 0.47385317, 0.55736301, 0.52762245],
 [0.57722016, 0.57718821, 0.5700168 , 0.59701639, 0.50802179, 0.44843445],
 [0.39456566, 0.38874   , 0.41657823, 0.39331915, 0.41278882, 0.39932694],
 [0.64290878, 0.65892973, 0.65161573, 0.61453231, 0.68637572, 0.70285098],
 [0.45496414, 0.43906435, 0.42968136, 0.4435593 , 0.38087753, 0.53327326],
 [0.53351884, 0.54998068, 0.56712283, 0.62159043, 0.74422592, 0.76377224],
 [0.67259377, 0.65934765, 0.64005251, 0.56716475, 0.41110739, 0.3281523 ]])

def createNeuralNetwork(hidden_units=9, dense_units=6, input_shape=(12-6,1), activation=['relu','sigmoid']):
    model = tf.keras.Sequential()
    model.add(tf.keras.layers.LSTM(hidden_units,input_shape=input_shape,activation=activation[0]))
    model.add(tf.keras.layers.Dense(units=dense_units,activation=activation[1]))
    model.add(tf.keras.layers.Dense(units=dense_units,activation=activation[1]))
    model.add(tf.keras.layers.Dense(units=dense_units,activation=activation[1]))
    model.compile(loss='mse', metrics=['mae', tf.keras.metrics.RootMeanSquaredError(), 'mse', tf.keras.metrics.R2Score()], optimizer='adam')
    return model

model   = createNeuralNetwork()
history = model.fit(trainDataForPrediction, trainDataTrueValues, epochs=300, batch_size=1, verbose=0)

from tensorflow import keras
import numpy as np

model = keras.Sequential()
model.add(keras.layers.Dense(10, activation="relu"))
model.add(keras.layers.Dense(1))

model.compile(
    optimizer="adam",
    loss=keras.losses.MeanSquaredError(),
    metrics=[keras.metrics.R2Score()]
)

data = np.random.random((1000, 5))
labels = data.sum(axis=1)

model.fit(data, labels, epochs=10)