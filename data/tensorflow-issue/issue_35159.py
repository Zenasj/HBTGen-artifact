inputs = Input(shape=(X.shape[1],))
hidden = BatchNormalization()(inputs)
hidden = Dense(1024, activation="relu")(hidden)
hidden = Dropout(0.5)(hidden)
hidden = BatchNormalization()(hidden)
hidden = Dense(512, activation="relu")(hidden)
hidden = Dropout(0.5)(hidden)
hidden = BatchNormalization()(hidden)
hidden = Dense(256, activation="relu")(hidden)
hidden = Dropout(0.5)(hidden)
hidden = BatchNormalization()(hidden)
hidden = Dense(128, activation="relu")(hidden)
params = Dense(2)(hidden)
dist = tfp.layers.DistributionLambda(normal_sp)(params) 
 
model = Model(inputs=inputs, outputs=dist)