import torch

torch.manual_seed(4)

a = torch.randn(4, 4)
b = a.data.new(a.size())
print(a)
print(b)

a_mkl = a.to_mkldnn()
c = a_mkl.data.new(a.size())  # <= error
print(a_mkl)
print(c)

tensor([[-0.9414,  1.2632, -0.1838,  0.1505],
        [ 0.1075, -0.2780, -2.6021,  0.6245],
        [-0.8684, -0.2051,  0.3976,  0.6699],
        [-0.0537,  0.0467, -1.7671, -2.1205]])
tensor([[9.3637e+36, 4.5612e-41, 9.3637e+36, 4.5612e-41],
        [1.4013e-45, 4.5914e-41, 6.7000e-37, 0.0000e+00],
        [6.7262e-44, 0.0000e+00, 6.7262e-44, 0.0000e+00],
        [4.0432e-38, 0.0000e+00, 2.3822e-44, 4.5612e-41]])
tensor([[-0.9414,  1.2632, -0.1838,  0.1505],
        [ 0.1075, -0.2780, -2.6021,  0.6245],
        [-0.8684, -0.2051,  0.3976,  0.6699],
        [-0.0537,  0.0467, -1.7671, -2.1205]], layout=torch._mkldnn)
tensor([[9.3637e+36, 4.5612e-41, 6.7000e-37, 0.0000e+00],
        [2.3822e-44, 0.0000e+00, 0.0000e+00, 0.0000e+00],
        [4.0132e-38, 0.0000e+00, 8.4078e-45, 0.0000e+00],
        [7.3909e+22, 1.4764e-41, 0.0000e+00, 0.0000e+00]],
       layout=torch._mkldnn)