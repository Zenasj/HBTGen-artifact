py
import torch

torch.manual_seed(420)

x = torch.randn(5, 5,)
values = torch.randn(5)

def func(x, values):
    indices = torch.tensor([0, 1, 2, 3, 4])
    y = torch.index_add(x, 0, indices, values)
    return y

print(func(x.clone(), values.clone()))
# tensor([[-0.7820, -0.2705, -0.1046, -1.1578, -0.7447],
#         [-0.6195, -1.5153, -0.2918,  0.8070, -0.2484],
#         [-0.5050, -2.0478, -1.8570, -0.6339,  0.9023],
#         [-0.6439,  1.3137,  0.0191,  0.1749,  0.1024],
#         [-0.2627, -1.4375,  0.5431, -1.5130,  0.5143]])

print(torch.compile(func)(x.clone(), values.clone()))
# tensor([[-0.7820, -0.4977, -0.4474, -0.6935, -0.2303],
#         [-0.3923, -1.5153, -0.4074,  1.4985,  0.4932],
#         [-0.1622, -1.9322, -1.8570,  0.1732,  1.7595],
#         [-1.1082,  0.6222, -0.7880,  0.1749,  0.1525],
#         [-0.7771, -2.1790, -0.3142, -1.5631,  0.5143]])