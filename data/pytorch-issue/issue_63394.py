x = checkpoint(lambda x: block(x, dtop_connect_rate), x, preserve_rng_state=True)