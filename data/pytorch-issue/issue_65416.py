import numpy as np
import torch

cuda_id = 0
if cuda_id == -1:
	device = torch.device("cpu")
else:
	device = torch.device("cuda:%d"%cuda_id)
A = torch.Tensor([[
	[   0.0000, -143.2371,    0.0000,    0.0000],
	[-143.2371,    0.0000,    0.0000,    0.0000],
	[   0.0000,    0.0000,   -1.0000,   86.5423],
	[   0.0000,    0.0000,    0.0000,    1.0000]]]).to(device)

B = torch.Tensor([[
	[-0.5000, -0.5000, -0.5000, -0.5000],
	[-0.5000, -0.5000, -0.5000, -0.5000],
	[-0.5000, -0.4980, -0.4961, -0.4941],
	[ 1.0000,  1.0000,  1.0000,  1.0000]]]).to(device)

C = torch.bmm(A, B)
print("C = \n", C)

# C = 
#  tensor([[[71.6186, 71.6186, 71.6186, 71.6186],
#          [71.6186, 71.6186, 71.6186, 71.6186],
#          [87.0423, 87.0403, 87.0384, 87.0364],
#          [ 1.0000,  1.0000,  1.0000,  1.0000]]])`

# C = 
#  tensor([[[0., 0., 0., 0.],
#          [0., 0., 0., 0.],
#          [0., 0., 0., 0.],
#          [0., 0., 0., 0.]]], device='cuda:0')