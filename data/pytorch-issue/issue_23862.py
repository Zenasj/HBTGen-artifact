import torch.nn as nn

create_w()

python
import torch
from timeit import timeit


def timing_test():
    from torch.nn.functional import conv2d

    test_img = torch.ones(10, 12, 100, 100)
    w1 = create_w()
    w2 = (w1 + 1) - 1

    print("Torch equal:", torch.equal(w1, w2))

    n = 100
    with torch.no_grad():
        t1 = timeit("conv2d(test_img, w1)", globals=locals(), number=n) / n
        t2 = timeit("conv2d(test_img, w2)", globals=locals(), number=n) / n

    print("Time w1:", t1)
    print("Time w2:", t2)
    print("Factor:", t1 / t2)

    print()
    print("w1 norm:", w1.norm())
    print("w2 norm:", w2.norm())

    print()
    print("w1 dtype:", w1.dtype)
    print("w2 dtype:", w2.dtype)

    print()
    print("w1 device:", w1.device)
    print("w2 device:", w2.device)

    print()
    print("w1 shape:", w1.shape)
    print("w2 shape:", w2.shape)


def create_w():
    return torch.tensor(
        [
            [
                [[2.0536e-03]],
                [[-6.5152e-02]],
                [[7.5900e-02]],
                [[1.9581e-02]],
                [[6.0192e-02]],
                [[1.1083e-01]],
                [[3.5546e-02]],
                [[1.0338e-01]],
                [[7.4448e-02]],
                [[3.8988e-02]],
                [[-1.3289e-02]],
                [[3.5973e-02]],
            ],
            [
                [[-1.8130e-03]],
                [[4.5211e-02]],
                [[-6.3141e-03]],
                [[-2.2000e-02]],
                [[5.5847e-02]],
                [[3.5140e-02]],
                [[5.5567e-02]],
                [[2.0592e-02]],
                [[2.9450e-02]],
                [[2.5826e-02]],
                [[2.6045e-03]],
                [[1.1359e-01]],
            ],
            [
                [[-3.5669e-04]],
                [[-2.0352e-02]],
                [[-1.0962e-02]],
                [[1.2939e-02]],
                [[2.0176e-03]],
                [[4.1796e-02]],
                [[7.6029e-02]],
                [[4.8062e-03]],
                [[2.0193e-02]],
                [[2.5245e-02]],
                [[6.2719e-02]],
                [[1.0437e-01]],
            ],
            [
                [[2.9016e-02]],
                [[3.6604e-02]],
                [[-2.4739e-03]],
                [[1.7465e-02]],
                [[4.5465e-02]],
                [[-2.0248e-02]],
                [[-1.0559e-03]],
                [[-3.3110e-02]],
                [[-2.6498e-02]],
                [[-1.1671e-02]],
                [[2.6471e-02]],
                [[1.4671e-02]],
            ],
            [
                [[3.1644e-02]],
                [[-7.5824e-02]],
                [[-3.2397e-02]],
                [[2.7205e-02]],
                [[-8.0184e-03]],
                [[3.5684e-02]],
                [[-4.3505e-04]],
                [[2.6388e-02]],
                [[4.5333e-04]],
                [[5.5965e-02]],
                [[4.2574e-02]],
                [[1.7094e-02]],
            ],
            [
                [[-1.7368e-02]],
                [[5.3762e-02]],
                [[-4.4826e-02]],
                [[-3.7706e-02]],
                [[1.9211e-03]],
                [[-4.3316e-02]],
                [[6.2763e-02]],
                [[1.0589e-02]],
                [[3.9296e-02]],
                [[-3.6488e-02]],
                [[6.7191e-02]],
                [[2.0684e-02]],
            ],
            [
                [[-4.8351e-02]],
                [[-1.3839e-02]],
                [[5.5983e-02]],
                [[-3.6999e-02]],
                [[-2.1908e-02]],
                [[-1.0006e-02]],
                [[-1.6682e-02]],
                [[6.8055e-02]],
                [[2.5191e-02]],
                [[3.9925e-02]],
                [[-1.5595e-02]],
                [[-3.6358e-02]],
            ],
            [
                [[-3.3860e-41]],
                [[1.3748e-41]],
                [[1.1227e-41]],
                [[5.3964e-42]],
                [[-1.8262e-41]],
                [[3.0524e-41]],
                [[2.0291e-42]],
                [[7.2924e-42]],
                [[-2.7940e-41]],
                [[-1.1212e-41]],
                [[-3.2091e-41]],
                [[-2.9832e-41]],
            ],
            [
                [[-5.4249e-03]],
                [[7.7659e-02]],
                [[4.2960e-02]],
                [[-1.2729e-01]],
                [[-6.1029e-02]],
                [[3.7938e-02]],
                [[7.4308e-03]],
                [[-1.8296e-02]],
                [[4.6577e-02]],
                [[3.3428e-02]],
                [[3.5875e-03]],
                [[1.0800e-02]],
            ],
            [
                [[-3.9751e-02]],
                [[-1.2280e-01]],
                [[4.4217e-02]],
                [[-2.8147e-02]],
                [[9.7940e-03]],
                [[1.0163e-03]],
                [[-5.6101e-02]],
                [[1.6846e-03]],
                [[-3.0928e-02]],
                [[-6.3853e-02]],
                [[-2.0385e-02]],
                [[-4.3640e-02]],
            ],
            [
                [[-5.4244e-02]],
                [[3.3747e-02]],
                [[-2.6432e-02]],
                [[-2.0302e-02]],
                [[3.0961e-02]],
                [[3.0394e-02]],
                [[5.0516e-02]],
                [[-3.3158e-03]],
                [[7.7341e-03]],
                [[-2.7420e-02]],
                [[9.3604e-02]],
                [[-3.1954e-02]],
            ],
            [
                [[-6.5509e-02]],
                [[9.1255e-02]],
                [[-5.3223e-02]],
                [[-9.5710e-03]],
                [[2.3625e-02]],
                [[6.9223e-03]],
                [[2.6769e-03]],
                [[2.8905e-02]],
                [[-7.6544e-03]],
                [[-1.5755e-01]],
                [[2.0315e-02]],
                [[3.1298e-02]],
            ],
            [
                [[-3.9999e-02]],
                [[-6.3408e-02]],
                [[-4.7921e-02]],
                [[5.0635e-02]],
                [[-8.8498e-02]],
                [[3.3315e-02]],
                [[7.9214e-02]],
                [[5.8254e-03]],
                [[-5.9077e-02]],
                [[6.2304e-02]],
                [[5.5565e-02]],
                [[4.1595e-02]],
            ],
            [
                [[3.9259e-02]],
                [[8.9200e-02]],
                [[-4.5643e-03]],
                [[5.1565e-02]],
                [[-1.5232e-02]],
                [[-1.9123e-02]],
                [[-3.0002e-02]],
                [[1.7376e-02]],
                [[5.7346e-02]],
                [[3.7609e-02]],
                [[5.2436e-03]],
                [[-4.0633e-02]],
            ],
            [
                [[1.4893e-02]],
                [[2.9597e-02]],
                [[2.0239e-02]],
                [[-9.2896e-02]],
                [[1.9449e-02]],
                [[-8.1253e-02]],
                [[-4.0866e-02]],
                [[-1.1120e-02]],
                [[-4.7219e-02]],
                [[-3.5702e-02]],
                [[-2.1840e-02]],
                [[6.9138e-02]],
            ],
        ]
    )


timing_test()