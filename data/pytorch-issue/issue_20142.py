import torch
import torch.nn as nn
x1 = torch.Tensor(1, 3, 8, 256, 256).uniform_().cuda()
x2 = torch.cat((x1, x1, x1),dim=0)
x2 = x2.cuda()
conv = nn.Conv3d(3, 64, kernel_size=(5,7,7)).cuda()
y1 = conv(x1)
y2 = conv(x2)
print(torch.mean(torch.abs(y2[0,...] - y1[0,...])))
x1 = torch.Tensor(4, 3, 8, 256, 256).uniform_().cuda()
x2 = torch.cat((x1, x1, x1),dim=0)
x2 = x2.cuda()
conv = nn.Conv3d(3, 64, kernel_size=(5,7,7)).cuda()
y1 = conv(x1)
y2 = conv(x2)
print(torch.mean(torch.abs(y2[0,...] - y1[0,...])))
x1 = torch.Tensor(1, 3, 256, 256).uniform_().cuda()
x2 = torch.cat((x1, x1, x1),dim=0)
x2 = x2.cuda()
conv = nn.Conv2d(3, 64, kernel_size=(7,7)).cuda()
y1 = conv(x1)
y2 = conv(x2)
print(torch.mean(torch.abs(y2[0,...] - y1[0,...])))
x1 = torch.Tensor(10, 3, 256, 256).uniform_().cuda()
x2 = torch.cat((x1, x1, x1),dim=0)
x2 = x2.cuda()
conv = nn.Conv2d(3, 64, kernel_size=(7,7)).cuda()
y1 = conv(x1)
y2 = conv(x2)
print(torch.mean(torch.abs(y2[0,...] - y1[0,...])))