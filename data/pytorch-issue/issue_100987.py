import torch.nn as nn

py
import torch
import torch.nn.functional as F

torch.manual_seed(420)

x = torch.randn(1, 3, 6, 6)

class Model(torch.nn.Module):
    def forward(self, x):
        y = F.avg_pool2d(x, kernel_size=3, stride=2, padding=1, ceil_mode=True)
        return y

func = Model().to('cpu')

jit_func = torch.compile(func)

res1 = func(x) # without jit
print(res1)
# tensor([[[[ 0.0772,  0.4163,  0.3751,  0.1080],
#           [ 0.0030,  0.3709,  0.3102, -0.0654],
#           [-0.2650, -0.0227, -0.1824, -0.3878],
#           [-0.1654,  0.1697, -0.1766, -0.2419]],
# 
#          [[-0.0822, -0.1538,  0.1087,  0.2112],
#           [ 0.3352,  0.1204, -0.1107,  0.2392],
#           [ 0.1832, -0.0405, -0.3160,  0.0071],
#           [ 0.2121,  0.2613,  0.1620,  0.1483]],
# 
#          [[-0.2359, -0.5062, -0.4587, -0.2245],
#           [-0.0929, -0.1154, -0.0436, -0.1164],
#           [ 0.1771,  0.1738,  0.1792,  0.2010],
#           [ 0.1106, -0.0964, -0.3565, -0.2361]]]])

res2 = jit_func(x)
print(res2)
# tensor([[[[ 0.0772,  0.4163,  0.3751,  0.0720],
#           [ 0.0030,  0.3709,  0.3102, -0.0436],
#           [-0.2650, -0.0227, -0.1824, -0.2585],
#           [-0.1103,  0.1131, -0.1177, -0.1075]],
# 
#          [[-0.0822, -0.1538,  0.1087,  0.1408],
#           [ 0.3352,  0.1204, -0.1107,  0.1595],
#           [ 0.1832, -0.0405, -0.3160,  0.0047],
#           [ 0.1414,  0.1742,  0.1080,  0.0659]],
# 
#          [[-0.2359, -0.5062, -0.4587, -0.1497],
#           [-0.0929, -0.1154, -0.0436, -0.0776],
#           [ 0.1771,  0.1738,  0.1792,  0.1340],
#           [ 0.0738, -0.0643, -0.2377, -0.1049]]]])