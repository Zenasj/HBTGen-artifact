import torch as t
tensors = [t.zeros(shape).cuda() for shape in shapes]
tensors2 = torch._foreach_add(tensors, 1)
print(any((i.numel() > 0 and i.min() == 0) for i in tensors2))

shapes = [torch.Size([13, 256]),
 torch.Size([51, 256]),
 torch.Size([256]),
 torch.Size([256]),
 torch.Size([256, 768]),
 torch.Size([768]),
 torch.Size([256, 256]),
 torch.Size([256]),
 torch.Size([256]),
 torch.Size([256]),
 torch.Size([256, 1024]),
 torch.Size([1024]),
 torch.Size([1024, 256]),
 torch.Size([256]),
 torch.Size([256]),
 torch.Size([256]),
 torch.Size([256, 768]),
 torch.Size([768]),
 torch.Size([256, 256]),
 torch.Size([256]),
 torch.Size([256]),
 torch.Size([256]),
 torch.Size([256, 1024]),
 torch.Size([1024]),
 torch.Size([1024, 256]),
 torch.Size([256]),
 torch.Size([256]),
 torch.Size([256]),
 torch.Size([256, 768]),
 torch.Size([768]),
 torch.Size([256, 256]),
 torch.Size([256]),
 torch.Size([256]),
 torch.Size([256]),
 torch.Size([256, 1024]),
 torch.Size([1024]),
 torch.Size([1024, 256]),
 torch.Size([256]),
 torch.Size([256]),
 torch.Size([256]),
 torch.Size([256, 768]),
 torch.Size([768]),
 torch.Size([256, 256]),
 torch.Size([256]),
 torch.Size([256]),
 torch.Size([256]),
 torch.Size([256, 1024]),
 torch.Size([1024]),
 torch.Size([1024, 256]),
 torch.Size([256]),
 torch.Size([256]),
 torch.Size([256]),
 torch.Size([32, 256]),
 torch.Size([32]),
 torch.Size([256, 16]),
 torch.Size([256]),
 torch.Size([13, 256]),
 torch.Size([13, 256]),
 torch.Size([51, 256]),
 torch.Size([256]),
 torch.Size([256]),
 torch.Size([256, 768]),
 torch.Size([768]),
 torch.Size([256, 256]),
 torch.Size([256]),
 torch.Size([256]),
 torch.Size([256]),
 torch.Size([256, 1024]),
 torch.Size([1024]),
 torch.Size([1024, 256]),
 torch.Size([256]),
 torch.Size([256]),
 torch.Size([256]),
 torch.Size([256, 768]),
 torch.Size([768]),
 torch.Size([256, 256]),
 torch.Size([256]),
 torch.Size([256]),
 torch.Size([256]),
 torch.Size([256, 1024]),
 torch.Size([1024]),
 torch.Size([1024, 256]),
 torch.Size([256]),
 torch.Size([256]),
 torch.Size([256]),
 torch.Size([256, 768]),
 torch.Size([768]),
 torch.Size([256, 256]),
 torch.Size([256]),
 torch.Size([256]),
 torch.Size([256]),
 torch.Size([256, 1024]),
 torch.Size([1024]),
 torch.Size([1024, 256]),
 torch.Size([256]),
 torch.Size([256]),
 torch.Size([256]),
 torch.Size([256, 768]),
 torch.Size([768]),
 torch.Size([256, 256]),
 torch.Size([256]),
 torch.Size([256]),
 torch.Size([256]),
 torch.Size([256, 1024]),
 torch.Size([1024]),
 torch.Size([1024, 256]),
 torch.Size([256]),
 torch.Size([256]),
 torch.Size([256]),
 torch.Size([0, 256]),
 torch.Size([0])]