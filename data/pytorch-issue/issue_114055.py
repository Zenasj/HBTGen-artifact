import torch
import torchvision
import torchvision.transforms as transforms
import torch.nn as nn
import os
import torch.nn.functional as F
gpu_device = torch.device("cuda")
cpu_device = torch.device("cpu")
class PreprocessAndCalculateModel(nn.Module):
    def __init__(self):
        super().__init__()
        self.max_unpool3d = nn.MaxUnpool3d(kernel_size=2, stride=2)
    def forward(self, x):
        device = x.device
        output =  self.max_unpool3d(x, indices=torch.ones_like(x).long())

        return output

real_inputs = torch.Tensor([[[[[ 1.2343e-01],
           [ 2.1832e-01],
           [ 2.4394e-01],
           [ 3.3443e-01],
           [ 3.0392e-01],
           [ 4.1693e-01],
           [ 1.9712e-01],
           [ 1.7021e-01]],

          [[ 8.7069e-02],
           [ 2.0914e-01],
           [ 2.2875e-01],
           [ 1.4918e-01],
           [ 4.0573e-01],
           [ 2.3099e-01],
           [ 2.8589e-01],
           [ 2.1306e-01]],

          [[ 1.5139e-01],
           [ 1.6772e-01],
           [ 4.1213e-01],
           [ 3.3529e-01],
           [ 2.0805e-01],
           [ 3.1247e-01],
           [ 2.0071e-01],
           [ 2.0077e-01]],

          [[ 1.2714e-01],
           [ 2.9122e-01],
           [ 2.9689e-01],
           [ 3.2505e-01],
           [ 2.3289e-01],
           [ 2.9387e-01],
           [ 2.5495e-01],
           [ 1.4430e-01]],

          [[ 2.9606e-01],
           [ 3.0760e-01],
           [ 2.2460e-01],
           [ 3.2090e-01],
           [ 2.5243e-01],
           [ 2.1117e-01],
           [ 2.4639e-01],
           [ 2.2432e-01]],

          [[ 1.2854e-01],
           [ 2.4672e-01],
           [ 2.2019e-01],
           [ 1.7257e-01],
           [ 2.3692e-01],
           [ 2.2905e-01],
           [ 2.2737e-01],
           [ 1.1454e-01]],

          [[ 1.0241e-01],
           [ 3.7105e-01],
           [ 2.7981e-01],
           [ 1.1335e-01],
           [ 1.9250e-01],
           [ 3.4577e-01],
           [ 1.7458e-01],
           [ 1.0813e-01]],

          [[ 3.4980e-02],
           [ 7.4763e-02],
           [ 8.2426e-02],
           [ 1.9297e-01],
           [ 3.2915e-02],
           [ 7.8863e-02],
           [ 6.5868e-02],
           [ 3.2912e-02]]],


         [[[-1.0812e-01],
           [-1.9843e-01],
           [-8.2050e-02],
           [-5.6052e-02],
           [-1.7178e-01],
           [-2.7479e-01],
           [-7.6243e-02],
           [-4.3532e-02]],

          [[-6.4340e-02],
           [ 3.9342e-02],
           [-5.3010e-02],
           [-8.4870e-02],
           [-3.3139e-01],
           [-1.7876e-01],
           [ 1.0113e-01],
           [ 2.1424e-02]],

          [[-8.9208e-02],
           [-1.9309e-02],
           [-2.2976e-01],
           [-6.0637e-02],
           [-3.2608e-02],
           [-1.0856e-01],
           [-4.6060e-02],
           [-1.3664e-04]],

          [[-2.3920e-01],
           [-2.2535e-01],
           [-3.9576e-02],
           [-2.1069e-01],
           [-1.8405e-01],
           [-1.7696e-01],
           [-8.6240e-02],
           [ 7.3218e-02]],

          [[-2.0382e-01],
           [-1.3077e-01],
           [-1.1954e-01],
           [-2.1004e-01],
           [-9.7529e-02],
           [ 6.7834e-02],
           [-1.0680e-01],
           [-5.5675e-03]],

          [[-6.4223e-02],
           [-5.1185e-02],
           [-2.3634e-01],
           [ 4.3995e-03],
           [ 6.9828e-03],
           [-2.1977e-01],
           [-2.6049e-01],
           [ 8.7300e-03]],

          [[-4.8530e-02],
           [ 9.2784e-02],
           [ 3.3536e-02],
           [-1.2121e-01],
           [-7.8482e-03],
           [-2.6304e-01],
           [-6.2755e-02],
           [ 1.0160e-01]],

          [[-1.6036e-01],
           [-2.9532e-02],
           [-1.4384e-01],
           [-1.9860e-01],
           [-5.6681e-02],
           [ 3.1964e-03],
           [-3.7984e-02],
           [ 1.0980e-01]]],


         [[[ 1.0411e-01],
           [ 1.1071e-01],
           [ 1.5360e-01],
           [ 1.4767e-01],
           [ 8.5276e-02],
           [ 1.5257e-01],
           [ 1.1553e-01],
           [ 1.0449e-01]],

          [[ 1.0188e-01],
           [ 3.8157e-02],
           [ 1.4778e-02],
           [ 1.1774e-03],
           [-5.1617e-02],
           [-2.1696e-02],
           [-1.5920e-02],
           [-8.2447e-03]],

          [[ 7.5436e-02],
           [ 1.0703e-01],
           [-7.0099e-02],
           [-7.6110e-02],
           [-1.8043e-01],
           [-1.1187e-01],
           [-3.9280e-02],
           [ 7.8629e-02]],

          [[ 4.5821e-02],
           [-5.7758e-02],
           [-8.0506e-02],
           [-1.2194e-01],
           [ 1.3320e-02],
           [-5.5219e-02],
           [-4.9408e-02],
           [-8.6589e-02]],

          [[ 4.1723e-02],
           [-5.4481e-02],
           [-1.0595e-01],
           [-1.2380e-01],
           [-1.7222e-02],
           [-8.9288e-03],
           [-1.1585e-03],
           [ 5.9530e-02]],

          [[ 3.2225e-02],
           [-1.5251e-01],
           [-1.5935e-01],
           [ 5.8487e-03],
           [-8.2185e-02],
           [-1.4606e-01],
           [ 6.5295e-03],
           [-4.9884e-02]],

          [[-1.5015e-02],
           [-1.0539e-01],
           [ 1.2244e-01],
           [-6.3562e-02],
           [ 2.9214e-02],
           [-1.1090e-01],
           [ 9.5641e-03],
           [-3.3521e-03]],

          [[-7.4697e-02],
           [-1.0648e-02],
           [-7.8860e-02],
           [-8.1880e-03],
           [-9.9335e-02],
           [ 7.1748e-02],
           [-7.3949e-02],
           [-2.2868e-02]]],


         [[[-3.0572e-02],
           [-1.7085e-02],
           [ 2.1618e-02],
           [-3.8401e-02],
           [ 1.7797e-01],
           [ 7.8905e-02],
           [ 3.3047e-02],
           [-1.2558e-01]],

          [[ 8.7771e-03],
           [ 4.6828e-03],
           [-8.9933e-02],
           [ 3.3104e-02],
           [ 7.3110e-02],
           [-3.2604e-02],
           [-3.6191e-02],
           [-1.6290e-02]],

          [[-3.2342e-02],
           [-1.1924e-01],
           [ 1.7842e-02],
           [ 8.8754e-02],
           [-1.5904e-02],
           [ 3.0128e-02],
           [-2.5883e-02],
           [-2.0975e-02]],

          [[-9.9444e-02],
           [ 3.1932e-02],
           [-5.3687e-02],
           [-5.6620e-02],
           [ 1.7921e-01],
           [ 6.1692e-02],
           [-1.4340e-02],
           [-5.6733e-02]],

          [[ 8.1399e-02],
           [-4.7514e-02],
           [-2.3199e-02],
           [ 7.7553e-02],
           [-5.4910e-02],
           [ 1.4217e-02],
           [-2.2168e-02],
           [ 6.9182e-02]],

          [[-1.1613e-01],
           [-2.8593e-02],
           [-7.1456e-02],
           [-7.0609e-02],
           [-1.5514e-01],
           [-1.2640e-01],
           [ 6.8975e-02],
           [-4.2414e-02]],

          [[ 7.7319e-02],
           [ 1.8783e-02],
           [ 1.2028e-01],
           [-2.5180e-02],
           [ 9.0280e-02],
           [ 2.3863e-02],
           [ 6.2147e-02],
           [-1.2380e-01]],

          [[-2.4212e-02],
           [-2.7453e-01],
           [-8.7719e-02],
           [-1.6363e-01],
           [-1.2169e-01],
           [-2.6450e-01],
           [-1.8085e-01],
           [-2.5661e-01]]],


         [[[ 1.6531e-02],
           [-6.3187e-02],
           [ 1.8095e-02],
           [ 1.2126e-01],
           [ 1.3270e-02],
           [-7.8449e-02],
           [ 5.5195e-02],
           [ 1.1059e-01]],

          [[-1.4949e-01],
           [-1.7311e-02],
           [-1.0033e-01],
           [-1.8463e-01],
           [-6.6708e-02],
           [ 4.8684e-03],
           [-4.5619e-02],
           [ 1.2141e-01]],

          [[-1.1623e-01],
           [-1.2892e-01],
           [-1.8393e-01],
           [-5.8956e-02],
           [ 8.8767e-02],
           [-1.4199e-01],
           [-9.4332e-02],
           [-8.5511e-02]],

          [[-1.2270e-01],
           [-3.3752e-01],
           [-1.2342e-01],
           [-1.2437e-01],
           [-1.3956e-01],
           [ 1.6992e-02],
           [ 5.1288e-02],
           [ 2.6124e-02]],

          [[-1.7910e-01],
           [ 6.9727e-02],
           [-9.7906e-02],
           [-1.1753e-01],
           [ 1.9595e-02],
           [-3.0899e-02],
           [-7.8667e-02],
           [-4.0286e-02]],

          [[-7.1608e-02],
           [-8.1379e-02],
           [-1.7044e-02],
           [-1.2873e-01],
           [-2.0515e-02],
           [-1.4315e-02],
           [-2.3768e-01],
           [ 3.1087e-02]],

          [[-8.5054e-02],
           [ 6.0878e-02],
           [ 7.8164e-02],
           [ 6.1237e-02],
           [-2.9137e-01],
           [-4.9828e-02],
           [-8.5638e-02],
           [ 3.9690e-02]],

          [[-1.1263e-01],
           [-1.6780e-02],
           [-1.7024e-01],
           [ 4.9307e-03],
           [ 1.5824e-01],
           [-4.9883e-02],
           [-5.5679e-02],
           [ 1.3045e-01]]],


         [[[ 1.2098e-01],
           [ 1.9994e-01],
           [ 5.1338e-02],
           [ 1.7915e-01],
           [ 1.0853e-01],
           [ 1.5459e-01],
           [ 4.3948e-02],
           [ 1.8449e-01]],

          [[ 1.1676e-01],
           [-8.2414e-02],
           [ 9.2062e-02],
           [ 4.7841e-02],
           [-4.1864e-02],
           [-1.2191e-01],
           [ 9.4142e-02],
           [ 2.5776e-01]],

          [[-1.7611e-01],
           [ 2.4457e-02],
           [ 5.5494e-02],
           [-9.6787e-02],
           [-8.6232e-02],
           [-1.8674e-03],
           [-1.3761e-01],
           [ 4.2910e-02]],

          [[ 8.0961e-04],
           [-7.0366e-02],
           [-7.9666e-02],
           [ 9.5444e-02],
           [-9.2626e-03],
           [ 7.6129e-02],
           [ 2.1917e-02],
           [ 1.0290e-01]],

          [[-1.1222e-01],
           [-2.8828e-02],
           [ 1.9992e-01],
           [ 1.4366e-01],
           [ 1.2744e-01],
           [-1.1952e-01],
           [ 2.1343e-02],
           [ 1.2264e-01]],

          [[-6.6992e-02],
           [ 1.4658e-01],
           [-1.1531e-02],
           [-2.3861e-01],
           [-1.1974e-02],
           [ 1.3008e-01],
           [ 7.4710e-02],
           [ 8.1055e-02]],

          [[-7.5545e-02],
           [ 5.2801e-02],
           [ 1.1128e-02],
           [ 4.1243e-02],
           [ 2.9090e-02],
           [ 1.4497e-01],
           [ 2.7069e-02],
           [ 2.6195e-01]],

          [[-2.0256e-01],
           [-6.7501e-02],
           [-9.8169e-03],
           [ 1.1326e-01],
           [ 3.7166e-02],
           [ 8.1604e-02],
           [ 6.7201e-02],
           [ 1.9263e-01]]],


         [[[-1.7040e-01],
           [-1.2138e-01],
           [-2.1598e-01],
           [-1.1316e-01],
           [-9.9682e-02],
           [-1.9350e-01],
           [-1.1121e-01],
           [-5.5619e-02]],

          [[-2.1754e-01],
           [-1.1488e-01],
           [-1.7675e-01],
           [-2.6864e-01],
           [ 8.3086e-02],
           [-7.3788e-02],
           [-1.0966e-01],
           [-1.1128e-01]],

          [[-2.3783e-01],
           [-1.6320e-01],
           [-1.3943e-02],
           [ 1.6223e-03],
           [-1.5815e-01],
           [-1.0284e-01],
           [-2.4445e-01],
           [-7.2021e-02]],

          [[-3.2380e-01],
           [-1.7674e-01],
           [-1.6043e-01],
           [-1.5850e-01],
           [-1.1499e-01],
           [-1.8472e-01],
           [-9.5304e-02],
           [-2.5096e-01]],

          [[-1.5348e-01],
           [-1.8046e-01],
           [-1.3652e-01],
           [-2.1697e-01],
           [-2.2054e-01],
           [-1.1783e-01],
           [-1.7993e-01],
           [-1.0529e-01]],

          [[-2.5025e-01],
           [-1.3815e-02],
           [-1.1533e-01],
           [-8.9425e-02],
           [-2.1138e-02],
           [-1.0271e-01],
           [-2.1750e-01],
           [-2.0939e-01]],

          [[-7.5777e-02],
           [-1.5818e-01],
           [-1.0835e-01],
           [-3.0029e-01],
           [-2.8875e-01],
           [-2.3005e-01],
           [-3.3646e-01],
           [-2.1662e-01]],

          [[-6.1609e-02],
           [-1.1307e-01],
           [ 1.1781e-02],
           [ 4.0038e-02],
           [ 5.8888e-03],
           [-6.3935e-02],
           [-3.6173e-02],
           [-8.6432e-02]]],


         [[[-4.6318e-02],
           [-3.8760e-02],
           [-1.9182e-01],
           [-9.7845e-02],
           [-2.6249e-01],
           [-2.0959e-01],
           [-1.5682e-01],
           [-1.7056e-01]],

          [[-6.5284e-02],
           [-2.4906e-01],
           [-2.1573e-01],
           [-1.7893e-01],
           [-9.7387e-02],
           [-3.9745e-01],
           [-2.8090e-01],
           [-5.5902e-02]],

          [[-2.4067e-02],
           [-2.7199e-01],
           [-2.1308e-01],
           [-2.8078e-01],
           [-1.0780e-01],
           [-2.6833e-01],
           [-2.6222e-01],
           [-2.2718e-01]],

          [[ 3.9315e-02],
           [-3.2867e-01],
           [-3.0874e-01],
           [-1.6766e-01],
           [-2.0226e-01],
           [-1.2355e-01],
           [-2.4036e-01],
           [-2.2222e-01]],

          [[-9.4883e-03],
           [-2.0938e-01],
           [-2.2527e-01],
           [-2.8385e-02],
           [-2.4324e-01],
           [-2.5395e-01],
           [-1.9884e-01],
           [-2.1178e-01]],

          [[-1.4303e-01],
           [-1.7778e-01],
           [-1.0200e-01],
           [-1.7001e-01],
           [-1.6012e-01],
           [-3.7072e-02],
           [ 6.5786e-02],
           [-2.9785e-01]],

          [[-2.2003e-01],
           [-1.8302e-01],
           [-1.3235e-02],
           [-2.2184e-01],
           [-2.2785e-01],
           [-5.0953e-02],
           [-5.3212e-02],
           [-2.2835e-01]],

          [[-1.5337e-01],
           [-1.2950e-01],
           [-7.1748e-02],
           [-3.4727e-02],
           [ 3.7245e-02],
           [-9.3265e-02],
           [-3.3962e-02],
           [-1.8208e-02]]]],



        [[[[ 2.7997e-01],
           [ 2.4860e-01],
           [ 4.4193e-01],
           [ 2.2152e-01],
           [ 4.1682e-01],
           [ 1.4945e-01],
           [ 3.6357e-01],
           [ 1.1686e-01]],

          [[ 1.9703e-01],
           [ 4.0830e-01],
           [ 2.3504e-01],
           [ 3.9671e-01],
           [ 1.4192e-01],
           [ 2.3419e-01],
           [ 1.0287e-01],
           [ 1.0551e-01]],

          [[ 1.6476e-01],
           [ 8.2574e-02],
           [ 3.2479e-01],
           [ 2.3710e-01],
           [ 3.4281e-01],
           [ 2.6282e-01],
           [ 2.6899e-01],
           [ 2.4191e-01]],

          [[ 7.7206e-02],
           [ 3.7699e-01],
           [ 1.4335e-01],
           [ 3.4300e-01],
           [ 2.1385e-01],
           [ 2.6547e-01],
           [ 4.5154e-01],
           [ 1.7164e-01]],

          [[ 2.1123e-01],
           [ 2.6418e-01],
           [ 1.4425e-01],
           [ 2.5982e-01],
           [ 1.4005e-01],
           [ 1.5775e-01],
           [ 2.4412e-01],
           [ 2.1054e-01]],

          [[ 1.2188e-01],
           [ 2.3089e-01],
           [ 1.2651e-01],
           [ 1.8172e-01],
           [ 8.1901e-02],
           [ 2.3054e-01],
           [ 2.9677e-01],
           [ 2.6153e-01]],

          [[ 1.0148e-01],
           [ 2.7022e-01],
           [ 2.5327e-01],
           [ 2.3454e-01],
           [ 3.0061e-01],
           [ 1.9647e-01],
           [ 3.2840e-01],
           [ 1.0478e-01]],

          [[ 5.7559e-02],
           [ 1.0070e-01],
           [ 4.3951e-02],
           [ 9.4568e-02],
           [ 1.4660e-01],
           [ 7.4479e-02],
           [ 9.0202e-02],
           [ 2.5004e-02]]],


         [[[-1.9358e-01],
           [-3.8309e-01],
           [-3.1162e-01],
           [-2.8709e-01],
           [-1.9359e-01],
           [-2.3057e-01],
           [-2.3301e-01],
           [-5.1584e-02]],

          [[-2.4958e-01],
           [-1.1181e-01],
           [-1.4400e-01],
           [-5.8107e-02],
           [-9.9858e-02],
           [ 7.0891e-03],
           [ 3.2022e-02],
           [ 3.2709e-02]],

          [[-1.3010e-01],
           [-1.0387e-01],
           [-1.0648e-01],
           [-1.7159e-01],
           [-1.6039e-01],
           [-2.4306e-02],
           [-1.7385e-01],
           [ 1.3986e-02]],

          [[-1.1007e-02],
           [-7.9070e-02],
           [-1.4117e-02],
           [-1.8639e-01],
           [-1.2303e-01],
           [-1.0796e-01],
           [-2.9807e-01],
           [-6.0484e-02]],

          [[-2.2257e-01],
           [-2.9050e-01],
           [-1.5961e-01],
           [-1.1851e-01],
           [ 5.1715e-03],
           [-7.7673e-02],
           [-1.7810e-02],
           [-1.1713e-02]],

          [[-1.3375e-01],
           [-8.3096e-03],
           [-5.0725e-02],
           [-1.1206e-02],
           [-1.8449e-02],
           [-1.2234e-02],
           [-1.0058e-01],
           [ 6.7759e-02]],

          [[ 4.9211e-02],
           [-9.3826e-02],
           [-1.0969e-01],
           [-1.6668e-01],
           [-1.7973e-01],
           [-1.8788e-01],
           [-2.4867e-01],
           [-4.5899e-04]],

          [[-1.3418e-01],
           [-5.2679e-02],
           [-1.0436e-01],
           [-4.4828e-02],
           [-1.5174e-01],
           [-9.1274e-02],
           [ 2.7672e-02],
           [ 1.8047e-01]]],


         [[[ 2.2331e-01],
           [-4.1967e-02],
           [ 2.0485e-01],
           [-9.5438e-02],
           [ 1.7874e-01],
           [-1.7827e-02],
           [ 1.1581e-01],
           [ 1.1161e-01]],

          [[-6.5976e-02],
           [-6.0066e-02],
           [-7.9106e-02],
           [-6.4749e-02],
           [-1.4779e-01],
           [-7.0583e-02],
           [ 1.3252e-01],
           [-3.4213e-03]],

          [[ 3.7183e-02],
           [-8.6045e-02],
           [-9.4339e-02],
           [-6.2740e-02],
           [-2.7994e-02],
           [ 9.3450e-02],
           [-3.4824e-02],
           [ 5.8662e-02]],

          [[-6.1410e-02],
           [-6.6970e-02],
           [ 3.4611e-02],
           [-2.5915e-01],
           [ 7.0547e-02],
           [ 2.7834e-03],
           [-3.3616e-02],
           [-8.1643e-02]],

          [[ 8.0551e-02],
           [ 2.4995e-02],
           [-1.0642e-01],
           [-1.5519e-01],
           [ 1.0873e-02],
           [-4.5241e-02],
           [-6.0869e-03],
           [-2.0270e-01]],

          [[ 3.7228e-02],
           [-1.1822e-01],
           [-4.4682e-02],
           [ 1.2819e-01],
           [-5.5553e-02],
           [ 6.6699e-02],
           [-1.9810e-01],
           [ 2.0469e-02]],

          [[-4.1668e-02],
           [-6.7993e-02],
           [ 1.1973e-01],
           [ 5.1012e-03],
           [ 3.9814e-02],
           [ 9.3204e-03],
           [-1.2065e-01],
           [-8.3858e-03]],

          [[-2.6940e-02],
           [ 1.0675e-01],
           [-1.3673e-01],
           [-2.9919e-02],
           [-9.9002e-02],
           [-1.1921e-01],
           [-1.1634e-01],
           [-1.1252e-01]]],


         [[[ 7.2702e-02],
           [ 1.0253e-01],
           [ 3.8102e-02],
           [ 4.3346e-02],
           [-1.3702e-01],
           [ 2.6465e-02],
           [-4.2302e-02],
           [ 2.6833e-02]],

          [[ 9.3122e-02],
           [ 1.4261e-01],
           [ 4.2174e-02],
           [ 1.1094e-01],
           [ 1.6222e-02],
           [ 1.0383e-01],
           [-8.7194e-02],
           [-4.4721e-02]],

          [[ 8.2270e-02],
           [-1.0776e-01],
           [ 3.0026e-02],
           [-4.1532e-02],
           [ 7.8284e-02],
           [-2.2521e-02],
           [ 6.5336e-02],
           [-1.9200e-02]],

          [[ 4.3750e-02],
           [ 1.5353e-01],
           [ 3.0632e-02],
           [ 3.1088e-02],
           [-8.3459e-02],
           [-1.8158e-02],
           [-4.9764e-02],
           [ 7.5678e-03]],

          [[ 5.1167e-02],
           [ 7.8394e-02],
           [ 4.7022e-02],
           [-1.2765e-01],
           [ 2.8246e-02],
           [-2.2826e-01],
           [ 1.9209e-02],
           [-9.3127e-02]],

          [[ 8.4130e-02],
           [-1.3634e-02],
           [-3.2067e-02],
           [ 1.9981e-03],
           [-7.6295e-02],
           [-6.8772e-02],
           [ 1.7086e-01],
           [ 2.6003e-02]],

          [[-2.5818e-03],
           [-1.1785e-01],
           [ 1.3068e-01],
           [-1.2751e-01],
           [-6.8494e-03],
           [-4.1625e-02],
           [-4.2312e-02],
           [-9.3058e-02]],

          [[-6.7931e-03],
           [-1.3872e-01],
           [-1.9354e-01],
           [-2.6057e-01],
           [-2.8337e-01],
           [-1.9621e-01],
           [-2.3457e-01],
           [-1.0872e-01]]],


         [[[-8.2547e-02],
           [-2.4095e-02],
           [-1.1017e-01],
           [ 6.4263e-02],
           [ 2.6867e-02],
           [ 3.1184e-03],
           [-2.4945e-03],
           [ 9.5885e-02]],

          [[-1.6192e-01],
           [ 5.3833e-03],
           [-2.4969e-02],
           [-2.9435e-02],
           [ 4.9505e-02],
           [-1.0534e-01],
           [ 8.4235e-02],
           [-7.2900e-02]],

          [[-1.0731e-02],
           [ 4.1184e-02],
           [ 3.1240e-02],
           [ 1.4689e-01],
           [-7.6519e-02],
           [-3.5581e-02],
           [-1.0024e-01],
           [-7.1832e-02]],

          [[ 8.5713e-02],
           [-1.6984e-01],
           [-3.0204e-02],
           [-7.7269e-03],
           [-1.2958e-01],
           [-2.0771e-01],
           [-1.1650e-01],
           [-9.5061e-03]],

          [[-4.8755e-02],
           [-1.0453e-02],
           [-5.0552e-02],
           [ 8.1814e-03],
           [-1.5961e-01],
           [ 2.8199e-02],
           [-1.3979e-01],
           [ 1.2412e-01]],

          [[-1.2549e-01],
           [ 1.1476e-01],
           [ 1.3081e-01],
           [-1.2481e-01],
           [-4.3528e-02],
           [-1.9167e-01],
           [-1.3651e-01],
           [ 5.4749e-02]],

          [[ 7.6271e-02],
           [ 2.1131e-02],
           [-1.3855e-01],
           [-2.5561e-02],
           [-2.0617e-01],
           [-1.9735e-01],
           [-9.1975e-02],
           [ 1.9676e-02]],

          [[-4.2376e-02],
           [-4.7474e-03],
           [-6.5287e-02],
           [-8.4715e-02],
           [-4.4162e-02],
           [-6.2729e-02],
           [ 2.5957e-02],
           [ 7.5413e-02]]],


         [[[-1.9150e-02],
           [ 1.1524e-01],
           [ 1.8500e-01],
           [ 1.1473e-01],
           [ 6.1769e-02],
           [ 1.2898e-01],
           [ 1.5008e-01],
           [-3.5310e-02]],

          [[-3.9329e-02],
           [-5.8002e-02],
           [ 1.2761e-01],
           [-9.9702e-02],
           [ 6.5853e-02],
           [ 9.3334e-02],
           [ 7.6752e-03],
           [ 1.2855e-01]],

          [[-1.6086e-01],
           [ 2.2205e-01],
           [-1.4031e-02],
           [ 2.9840e-02],
           [-3.2843e-03],
           [ 7.0395e-02],
           [ 6.6518e-02],
           [ 7.8914e-02]],

          [[-8.6469e-02],
           [-1.6727e-01],
           [-9.6429e-02],
           [ 1.4665e-01],
           [ 1.6519e-01],
           [-1.2050e-02],
           [ 3.2355e-03],
           [ 1.1326e-01]],

          [[ 8.2185e-02],
           [ 2.7554e-02],
           [-2.3364e-02],
           [ 1.4012e-01],
           [-5.3676e-02],
           [ 8.4225e-02],
           [ 1.2387e-01],
           [ 2.3187e-01]],

          [[-9.4344e-02],
           [-2.9905e-02],
           [ 1.0201e-01],
           [ 3.6963e-02],
           [-5.2353e-02],
           [ 1.0962e-01],
           [ 9.4681e-03],
           [ 9.0862e-02]],

          [[ 2.8906e-02],
           [ 1.0799e-01],
           [ 5.7392e-03],
           [ 1.8101e-01],
           [ 1.0277e-01],
           [ 9.5224e-02],
           [-9.4869e-03],
           [ 1.0943e-01]],

          [[-1.1558e-01],
           [-1.1797e-01],
           [ 7.1731e-02],
           [ 1.1946e-01],
           [ 1.1912e-01],
           [-4.1248e-02],
           [ 1.1162e-01],
           [ 1.2175e-01]]],


         [[[-2.0745e-01],
           [-5.3007e-02],
           [-1.6118e-01],
           [-2.1224e-03],
           [-1.0768e-01],
           [-7.1476e-02],
           [-1.3816e-01],
           [-1.3151e-01]],

          [[-1.6400e-01],
           [-2.9366e-01],
           [-1.3908e-01],
           [-1.0604e-01],
           [-3.9395e-02],
           [-2.4680e-01],
           [-1.7391e-01],
           [-1.6294e-01]],

          [[-6.9140e-02],
           [-7.4890e-02],
           [-1.3432e-01],
           [-1.5264e-01],
           [-1.0304e-01],
           [-3.0908e-01],
           [-3.9450e-02],
           [-2.1979e-01]],

          [[-1.0290e-01],
           [-1.2179e-01],
           [-1.2843e-01],
           [-6.2938e-03],
           [-3.8378e-01],
           [-2.3864e-01],
           [-1.6501e-01],
           [-1.5136e-01]],

          [[-2.4492e-01],
           [-1.1585e-01],
           [-9.0035e-03],
           [-3.1615e-01],
           [-1.1196e-01],
           [-2.2110e-01],
           [-1.0169e-01],
           [-1.5045e-01]],

          [[-1.3875e-01],
           [ 2.4127e-04],
           [-1.8807e-01],
           [-8.5797e-02],
           [-2.1007e-01],
           [-1.2102e-01],
           [-1.0883e-01],
           [-1.6625e-01]],

          [[-1.3799e-01],
           [-2.9068e-01],
           [-3.2669e-01],
           [-2.8563e-01],
           [-2.1213e-01],
           [-2.4667e-01],
           [-1.1985e-01],
           [-1.4955e-01]],

          [[-1.1624e-02],
           [ 2.8602e-02],
           [-4.1320e-02],
           [-1.4785e-01],
           [-7.6294e-02],
           [ 5.2523e-02],
           [-8.5217e-02],
           [-9.7107e-02]]],


         [[[ 4.7296e-02],
           [-1.3757e-01],
           [-1.9959e-01],
           [-2.3005e-01],
           [-2.1548e-01],
           [-1.6168e-01],
           [-1.3333e-01],
           [-1.3043e-01]],

          [[-9.0838e-02],
           [-1.7398e-01],
           [-1.5973e-01],
           [-4.2007e-01],
           [-1.7794e-01],
           [-6.5875e-02],
           [-1.0413e-01],
           [-2.9140e-01]],

          [[ 5.6489e-02],
           [-1.4907e-01],
           [ 1.2863e-02],
           [-2.3961e-01],
           [-2.3273e-01],
           [-1.1663e-01],
           [-2.5498e-01],
           [-2.2584e-01]],

          [[-6.9805e-02],
           [-1.0149e-01],
           [-2.4221e-01],
           [-1.2135e-01],
           [-1.0742e-01],
           [-3.4499e-01],
           [-1.6093e-01],
           [-3.0047e-01]],

          [[ 2.3375e-02],
           [-1.2219e-01],
           [-3.1714e-01],
           [-1.0911e-01],
           [-9.8778e-02],
           [-1.3998e-01],
           [-1.2910e-01],
           [-2.8307e-01]],

          [[-6.0836e-02],
           [-1.5396e-01],
           [ 9.6816e-03],
           [-1.9501e-01],
           [-1.6876e-01],
           [-9.0563e-02],
           [-1.7965e-01],
           [-2.7941e-01]],

          [[-1.2320e-01],
           [-2.0457e-02],
           [-3.7362e-02],
           [-1.6228e-01],
           [-2.0003e-01],
           [-1.8647e-01],
           [-1.5415e-01],
           [-2.1311e-01]],

          [[-5.4310e-02],
           [-1.2538e-02],
           [-6.8305e-02],
           [-4.9769e-02],
           [ 2.6580e-03],
           [-9.0708e-02],
           [-1.2948e-02],
           [-8.3895e-03]]]]])
model = PreprocessAndCalculateModel()
x = real_inputs
output_gpu = model.to(gpu_device)(x.cuda())
output_cpu = model.to(cpu_device)(x.cpu())
print(torch.allclose(output_gpu.cpu(), output_cpu, atol=1e-1))