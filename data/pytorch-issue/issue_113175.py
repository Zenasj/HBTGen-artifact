import torch

def fn(x, y, device):
  x = torch._C._special.special_modified_bessel_k1(input=x, out=y)        
  x = torch.argmax(input=x, )# if comment out argmax, no error would be triggered      
  return x

device = 'cpu'
#device = 'cuda'# in 'cuda', no error.
x = torch.tensor([[-46143.80078125, -888887.5, 742947.25, 591846.625, -425750.53125, -160263.953125, 515385.34375, -237312.609375, -63502.08203125], [-879467.625, -732244.375, 637310.9375, -384376.90625, -262168.9375, -43808.3984375, -440703.625, -884941.125, -493260.71875], [446532.375, -138495.71875, -894550.6875, -774823.375, -302313.875, 966388.875, -79594.8671875, 238637.4375, 417527.75], [-550014.25, -883448.875, 418899.28125, -181903.390625, 149709.125, -318021.625, 211921.890625, -408180.15625, 795559.3125], [-82286.375, -970763.5625, 351125.5625, 492281.0, 304095.09375, 621572.4375, 162438.796875, 26294.779296875, 594204.375], [15653.5439453125, 71039.703125, -719585.3125, 854744.0, 452889.875, 159875.390625, 233036.53125, 391324.75, 182663.875], [-15242.54296875, -410455.875, -204737.078125, 185112.609375, 94294.5546875, -876445.875, 5038.197265625, -77698.9375, -701279.3125], [-455445.65625, 421578.59375, 908607.9375, 906770.875, -559925.75, 18441.125, 114111.609375, 884402.1875, -498772.625], [-123298.7734375, 494476.5625, -311580.46875, -525244.0625, 297645.78125, -106437.40625, 571761.1875, 804279.3125, -271676.46875], [-331699.03125, 726228.0625, -859502.625, -824556.5625, -940866.8125, -907604.625, 346474.46875, 325815.0625, -873393.75]], dtype=torch.float32).to(device)
#if generate x randomly with this shape and dtype, no error would be encountered 
y = torch.rand([10, 9], dtype=torch.float32).to(device)
eag = fn(x, y, device)# res on eagermode.
opt = torch.compile(fn, mode='default')(x, y, device)# res on torch.compile with default setting.

same_val = torch.allclose(eag.to('cpu'), 
                            opt.to('cpu'), 
                            rtol=1e-3, atol=1e-3, 
                            equal_nan=True)
if same_val == False : 
        raise ValueError('diff value')