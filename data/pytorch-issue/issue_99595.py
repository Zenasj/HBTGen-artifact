import torch

m = torch.tensor([[0,1,2,3,4],[10,11,12,13,14],[20,21,22,23,24],[30,31,32,33,34],[40,41,42,43,44]])
m_f = m.type(torch.float)
print("m:", m)
print("m_f:", m_f)

index = torch.tensor([[0],[1],[2],[3],[4]])
print("index:", index)

print(torch.gather(m, dim=0, index=index ))
print(torch.gather(m_f, dim=0, index=index ))

m: tensor([[ 0,  1,  2,  3,  4],
        [10, 11, 12, 13, 14],
        [20, 21, 22, 23, 24],
        [30, 31, 32, 33, 34],
        [40, 41, 42, 43, 44]])
m_f: tensor([[ 0.,  1.,  2.,  3.,  4.],
        [10., 11., 12., 13., 14.],
        [20., 21., 22., 23., 24.],
        [30., 31., 32., 33., 34.],
        [40., 41., 42., 43., 44.]])
index: tensor([[0],
        [1],
        [2],
        [3],
        [4]])
tensor([[ 0],
        [10],
        [20],
        [30],
        [40]])
tensor([[0.],
        [1.],
        [2.],
        [3.],
        [4.]])

tensor([[ 0],
        [10],
        [20],
        [30],
        [40]])

tensor([[0.],
        [1.],
        [2.],
        [3.],
        [4.]])

m: tensor([[ 0,  1,  2,  3,  4],
        [10, 11, 12, 13, 14],
        [20, 21, 22, 23, 24],
        [30, 31, 32, 33, 34],
        [40, 41, 42, 43, 44]])
m_f: tensor([[ 0.,  1.,  2.,  3.,  4.],
        [10., 11., 12., 13., 14.],
        [20., 21., 22., 23., 24.],
        [30., 31., 32., 33., 34.],
        [40., 41., 42., 43., 44.]])
index: tensor([[0],
        [1],
        [2],
        [3],
        [4]])
tensor([[ 0],
        [10],
        [20],
        [30],
        [40]])
tensor([[ 0.],
        [10.],
        [20.],
        [30.],
        [40.]])

m: tensor([[ 0,  1,  2,  3,  4],
        [10, 11, 12, 13, 14],
        [20, 21, 22, 23, 24],
        [30, 31, 32, 33, 34],
        [40, 41, 42, 43, 44]])
m_f: tensor([[ 0.,  1.,  2.,  3.,  4.],
        [10., 11., 12., 13., 14.],
        [20., 21., 22., 23., 24.],
        [30., 31., 32., 33., 34.],
        [40., 41., 42., 43., 44.]])
index: tensor([[0],
        [1],
        [2],
        [3],
        [4]])
tensor([[ 0],
        [10],
        [20],
        [30],
        [40]])
tensor([[ 0.],
        [10.],
        [20.],
        [30.],
        [40.]])