for step in range(1, len(train_loader) + 1):
    batch = next(iter(train_loader)) # <- issue here
    ...

for step, batch in enumerate(train_loader):
    ...